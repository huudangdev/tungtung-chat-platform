{"version":3,"file":"messages.js","sourceRoot":"","sources":["../../../src/utils/livechat/messages.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,oEAAwC;AACxC,2DAA8C;AAC9C,qCAAuC;AACvC,oCAAkF;AAElF,aAAO,EAAE,CAAA;AAET,IAAM,QAAQ,GAAG,IAAI,kBAAG,CAAC,EAAE,CAAC,CAAA;AAE5B,SAAe,eAAe;;;;;;oBAC5B,OAAO,CAAC,GAAG,CAAC,wCAAwC,CAAC,CAAA;oBACjD,KAAK,GAAG,QAAQ,CAAC,KAAK,CAAA;yBACtB,CAAA,CAAC,KAAK,IAAI,KAAK,KAAK,EAAE,CAAA,EAAtB,wBAAsB;oBACJ,qBAAM,QAAQ,CAAC,YAAY,CAAC,oBAAW,CAAC,EAAA;;oBAApD,OAAO,GAAK,CAAA,SAAwC,CAAA,QAA7C;oBACf,KAAK,GAAG,OAAO,IAAI,OAAO,CAAC,KAAK,CAAA;;wBAGlC,sBAAO,KAAK,EAAA;;;;CACb;AAED,SAAe,OAAO,CAAE,KAAa;;;;;;oBACnC,OAAO,CAAC,GAAG,CAAC,+BAA+B,CAAC,CAAA;oBAC3B,qBAAM,QAAQ,CAAC,IAAI,EAAE,EAAA;;oBAA9B,IAAI,GAAK,CAAA,SAAqB,CAAA,KAA1B;oBACZ,sBAAO,IAAI,EAAA;;;;CACZ;AAED,SAAe,QAAQ;;;;;wBACP,qBAAM,eAAe,EAAE,EAAA;;oBAA/B,KAAK,GAAG,SAAuB;oBACxB,qBAAM,OAAO,CAAC,KAAK,CAAC,EAAA;;oBAA3B,IAAI,GAAG,SAAoB;oBAC3B,GAAG,GAAG,IAAI,IAAI,IAAI,CAAC,GAAG,CAAA;oBACtB,UAAU,GAAG,EAAE,KAAK,OAAA,EAAE,GAAG,KAAA,EAAE,GAAG,EAAE,4BAA4B,EAAE,CAAA;oBAC9D,WAAW,GAAG,EAAE,KAAK,OAAA,EAAE,GAAG,KAAA,EAAE,GAAG,EAAE,4BAA4B,EAAE,CAAA;oBACtD,qBAAM,QAAQ,CAAC,WAAW,CAAC,UAAU,CAAC,EAAA;;oBAA/C,MAAM,GAAG,SAAsC;oBAC/C,GAAG,GAAG,MAAM,IAAI,MAAM,CAAC,OAAO,IAAI,MAAM,CAAC,OAAO,CAAC,GAAG,CAAA;oBACpD,QAAQ,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,8BAAqB,EAAE,EAAE,GAAG,KAAA,EAAE,CAAC,CAAA;oBAElE,KAAA,CAAA,KAAA,OAAO,CAAA,CAAC,GAAG,CAAA;yHAKX,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE,IAAI,EAAE,IAAI,CAAC;oBAGlC,KAAA,CAAA,KAAA,IAAI,CAAA,CAAC,SAAS,CAAA;oBAAC,qBAAM,QAAQ,CAAC,WAAW,CAAC,GAAG,EAAE,WAAW,CAAC,EAAA;;8BAA3D,cAAe,SAA4C,EAAE,IAAI,EAAE,IAAI,EAAC;oBAGxE,KAAA,CAAA,KAAA,IAAI,CAAA,CAAC,SAAS,CAAA;oBAAC,qBAAM,QAAQ,CAAC,YAAY,CAAC,GAAG,EAAE,EAAE,KAAK,OAAA,EAAE,CAAC,EAAA;;8BAA1D,cAAe,SAA2C,EAAE,IAAI,EAAE,IAAI,EAAC;oBAGvE,KAAA,CAAA,KAAA,IAAI,CAAA,CAAC,SAAS,CAAA;oBAAC,qBAAM,QAAQ,CAAC,aAAa,CAAC,GAAG,EAAE,EAAE,GAAG,KAAA,EAAE,CAAC,EAAA;;8BAAzD,cAAe,SAA0C,EAAE,IAAI,EAAE,IAAI,EAAC;oBAGtE,KAAA,CAAA,KAAA,IAAI,CAAA,CAAC,SAAS,CAAA;oBAAC,qBAAM,QAAQ,CAAC,kBAAkB,CAAC,2BAAkB,CAAC,EAAA;;8BAApE,cAAe,SAAqD,EAAE,IAAI,EAAE,IAAI,EAAC;oBAGjF,KAAA,CAAA,KAAA,IAAI,CAAA,CAAC,SAAS,CAAA;oBAAC,qBAAM,QAAQ,CAAC,qBAAqB,CAAC,QAAQ,CAAC,EAAA;;oBApB7D,cAAY,KAoBZ,cAAe,SAA8C,EAAE,IAAI,EAAE,IAAI,EAAC,WAEzE,EAAC,CAAA;;;;;CACH;AAED,QAAQ,EAAE,CAAC,KAAK,CAAC,UAAC,CAAC,IAAK,OAAA,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,EAAhB,CAAgB,CAAC,CAAA","sourcesContent":["import Api from '../../lib/api/Livechat'\nimport * as settings from '../../lib/settings'\nimport { silence } from '../../lib/log'\nimport { mockVisitor, mockOfflineMessage, mockVisitorNavigation } from '../config'\n\nsilence()\n\nconst livechat = new Api({})\n\nasync function getVisitorToken () {\n  console.log('\\nPreparing visitor token for tests...')\n  let token = settings.token\n  if (!token || token === '') {\n    const { visitor } = await livechat.grantVisitor(mockVisitor)\n    token = visitor && visitor.token\n  }\n\n  return token\n}\n\nasync function getRoom (token: string) {\n  console.log('\\nPreparing room for tests...')\n  const { room } = await livechat.room()\n  return room\n}\n\nasync function messages () {\n  const token = await getVisitorToken()\n  const room = await getRoom(token)\n  const rid = room && room._id\n  const newMessage = { token, rid, msg: 'sending livechat message..' }\n  const editMessage = { token, rid, msg: 'editing livechat message..' }\n  const result = await livechat.sendMessage(newMessage)\n  const _id = result && result.message && result.message._id\n  const pageInfo = Object.assign({}, mockVisitorNavigation, { rid })\n\n  console.log(`\n\nDemo of API livechat query helpers\n\nSend Livechat Message \\`livechat.sendMessage()\\`:\n${JSON.stringify(result, null, '\\t')}\n\nEdit Livechat Message \\`livechat.editMessage()\\`:\n${JSON.stringify(await livechat.editMessage(_id, editMessage), null, '\\t')}\n\nLoad Livechat Messages \\`livechat.loadMessages()\\`:\n${JSON.stringify(await livechat.loadMessages(rid, { token }), null, '\\t')}\n\nDelete Livechat Message \\`livechat.deleteMessage()\\`:\n${JSON.stringify(await livechat.deleteMessage(_id, { rid }), null, '\\t')}\n\nSend Livechat Offline Message \\`livechat.sendOfflineMessage()\\`:\n${JSON.stringify(await livechat.sendOfflineMessage(mockOfflineMessage), null, '\\t')}\n\nSend Livechat Visitor Navigation \\`livechat.sendVisitorNavigation()\\`:\n${JSON.stringify(await livechat.sendVisitorNavigation(pageInfo), null, '\\t')}\n\n  `)\n}\n\nmessages().catch((e) => console.error(e))\n"]}